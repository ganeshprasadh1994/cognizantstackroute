var fs = require('fs');
var fn=["India2011.csv","IndiaSC2011.csv","IndiaST2011.csv"];
var obj={};
var m=0;
for(var i=0;i<fn.length;i++)
{
 var f = fs.readFileSync(fn[i],"utf8");
 var line = f.split("\n");
 var hd=line[0].split(",");
 var lit=[];
 var ag=hd.indexOf("Age-group"),
 tru=hd.indexOf("Total/ Rural/ Urban");
 lit[0]=hd.indexOf("Educational level - Literate without educational level - Persons");
 lit[1]=hd.indexOf("Educational level - Below Primary - Persons");
 lit[2]=hd.indexOf("Educational level - Primary - Persons");
 lit[3]=hd.indexOf("Educational level - Middle - Persons");
 lit[4]=hd.indexOf("Educational level - Matric/Secondary - Persons");
 lit[5]=hd.indexOf("Educational level - Higher secondary/Intermediate/Pre-University/Senior secondary - Persons");
 lit[6]=hd.indexOf("Educational level - Non-technical diploma or certificate not equal to degree - Persons");
 lit[7]=hd.indexOf("Educational level - Technical diploma or certificate not equal to degree - Persons");
 lit[8]=hd.indexOf("Educational level - Graduate & above - Persons");
 lit[9]=hd.indexOf("Educational level - Unclassified - Persons");
 for(var j=1;j<line.length;j++)
 {
   var cl=line[j].split(",");
   if(cl[ag]==="All ages" && cl[tru]==="Total")
   {
     for(var k=15;k<hd.length;k++)
     {
       for(var l=0;l<lit.length;l++)
       {
         if(lit[l]==k)
         {
           var person={}
           if(person[m][cl[lit[i]]]===undefined)
           person[m][cl[lit[l]]]=parseInt(cl[lit[i]]);
           else {
           person[m][cl[lit[l]]]+=parseInt(cl[lit[l]]);
           }
           obj[cl[lit[l]]]=person[m][cl[lit[l]]];
         }
       }
     }
   }
 }
}
console.log(obj);
/*var b1=JSON.stringify(obj);
fs.appendFile('out2.json',b1,'utf8',function(err){
  if(err) throw err;
});*/
